# Network Speed Test Suite

Comprehensive HTTP vs gRPC performance testing suite for dstack CVM with automated deployment and benchmarking.

## Quick Start

Run a complete benchmark on any server with a single command:

```bash
./run-bench.sh <ssh-server-name> <service-url>
```

### Example Usage

```bash
# Test on dev1 server via dstack gateway
./run-bench.sh dev1 https://6fd2b3f13a7deedb10480c914496e6daddefe1a6-8090.app.kvin.wang:12004/
```

## What It Does

1. **üöÄ Auto-deploys** server components via SSH
2. **üîß Sets up** nginx proxy + gRPC server using Docker Compose
3. **üß™ Runs** comprehensive HTTP and gRPC speed tests
4. **üìä Generates** performance comparison report
5. **üßπ Cleans up** remote server automatically

## Architecture

```
Client ‚îÄ‚îÄ‚ñ∫ Internet ‚îÄ‚îÄ‚ñ∫ Reverse Proxy/Gateway ‚îÄ‚îÄ‚ñ∫ Target Server
                            (your-url)              (nginx + gRPC)
```

## Test Results

The suite tests 200MB file transfers and compares:

| Protocol | Upload Speed | Download Speed | Use Case |
|----------|--------------|----------------|----------|
| HTTPS | ~37 MB/s | ~6 MB/s | File transfers |
| gRPC | ~5.4 MB/s | ~5.3 MB/s | Streaming APIs |

## Requirements

- SSH access to target server
- Docker and Docker Compose on target server
- Python 3.8+ on client machine

## Output

- Console: Formatted performance table
- File: `benchmark_results.json` with detailed metrics
- Report: Complete analysis in `REPORT.md`

## Manual Testing

For detailed testing or custom scenarios, see:
- `server/README.md` - Manual server setup
- `client/README.md` - Individual test tools

## Benchmark Results

| Test Date | Server | CPU Cores | Memory | OS Version | HTTPS Upload (MB/s) | HTTPS Download (MB/s) | gRPC Upload (MB/s) | gRPC Download (MB/s) | Best Upload | Best Download |
|-----------|---------|-----------|---------|------------|--------------------|-----------------------|--------------------|----------------------|-------------|---------------|
| 2025-08-14 04:52:12 | gpu08-test0 | 16 | 30.4G | DStack 0.5.2 | **39.15**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 5.03<br/>`‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 10.62<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **5.04**<br/>`‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | HTTPS (39.15) | gRPC (5.04) |
| 2025-08-14 04:37:49 | gpu08-test1 | 2 | 30.4G | DStack 0.5.2 | **33.88**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 5.76<br/>`‚ñà‚ñè‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 8.47<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **5.37**<br/>`‚ñà‚ñè‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | HTTPS (33.88) | gRPC (5.37) |
| 2025-08-14 04:43:51 | tdxlab-test0 | 2 | 30.4G | DStack 0.5.3 | **71.32**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë` | 86.25<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà` | 12.81<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **91.22**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà` | HTTPS (71.32) | gRPC (91.22) |
| 2025-08-14 04:46:28 | tdxlab-test1 | 16 | 30.4G | DStack 0.5.3 | **52.30**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 87.83<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà` | 13.83<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **88.13**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà` | HTTPS (52.30) | gRPC (88.13) |
| 2025-08-14 04:48:01 | tdxlab-test1 | 16 | 30.4G | DStack 0.5.3 | **64.87**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè‚ñë‚ñë‚ñë` | 82.63<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè` | 14.00<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **85.53**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä` | HTTPS (64.87) | gRPC (85.53) |
| 2025-08-14 05:48:29 | prod2-test0 | 8 | 14.7G | DStack 0.3.6 | **95.38**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà` | 86.25<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà` | 15.88<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **77.50**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë` | HTTPS (95.38) | HTTPS (86.25) |
| 2025-08-14 05:54:19 | prod5-test0 | 8 | 14.7G | DStack 0.3.6 | **33.90**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 32.77<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 7.50<br/>`‚ñà‚ñà‚ñà‚ñà‚ñã‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **29.47**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | HTTPS (33.90) | HTTPS (32.77) |
| 2025-08-14 05:55:57 | prod5-test0 | 8 | 14.7G | DStack 0.3.6 | **47.88**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 48.24<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 9.48<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **46.72**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | HTTPS (47.88) | HTTPS (48.24) |
| 2025-08-14 05:58:24 | prod8-test0 | 8 | 14.7G | DStack 0.3.6 | **41.49**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 43.96<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 7.96<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **62.15**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç‚ñë‚ñë‚ñë‚ñë‚ñë` | HTTPS (41.49) | gRPC (62.15) |
| 2025-08-14 05:18:55 | prod10-test0 | 8 | 14.7G | DStack 0.3.6 | **16.03**<br/>`‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 9.13<br/>`‚ñà‚ñà‚ñè‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | 11.47<br/>`‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | **7.87**<br/>`‚ñà‚ñä‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë` | HTTPS (16.03) | HTTPS (9.13) |

---
